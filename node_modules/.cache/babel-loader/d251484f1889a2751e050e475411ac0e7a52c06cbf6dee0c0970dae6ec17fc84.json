{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function TransactionForm(_ref){let{onAddTransaction}=_ref;const[titre,setTitre]=useState('');const[montant,setMontant]=useState('');const[type,setType]=useState('depense');const[date,setDate]=useState('');const[lieu,setLieu]=useState('');const[description,setDescription]=useState('');const[categories,setCategories]=useState([]);const[sousCategories,setSousCategories]=useState([]);const[selectedCategory,setSelectedCategory]=useState('');const[selectedSousCategorie,setSelectedSousCategorie]=useState('');const[utilisateurs,setUtilisateurs]=useState([]);const[selectedUtilisateurs,setSelectedUtilisateurs]=useState([]);useEffect(()=>{const fetchData=async()=>{try{const categoriesResponse=await axios.get('http://localhost:8888/finance-flow/finance-flow/src/api.php?getCategories=true');setCategories(categoriesResponse.data.categories||[]);setSousCategories(categoriesResponse.data.sousCategories||[]);const utilisateursResponse=await axios.get('http://localhost:8888/finance-flow/finance-flow/src/api.php?getUtilisateurs=true');setUtilisateurs(utilisateursResponse.data||[]);}catch(error){console.error(\"Erreur lors de la récupération des données :\",error);}};fetchData();},[]);const handleSubmit=async e=>{e.preventDefault();if(!selectedCategory){console.warn(\"Catégorie non sélectionnée.\");return;}const transaction={titre,montant:parseFloat(montant),type,date,lieu,description,categorie_id:selectedCategory,sous_categorie_id:selectedSousCategorie};try{const response=await axios.post('http://localhost:8888/finance-flow/finance-flow/src/api.php',transaction);if(response.data.status==='success'){const transactionId=response.data.transaction_id;// Partager la transaction si des utilisateurs sont sélectionnés\nif(selectedUtilisateurs.length>0){await axios.post('http://localhost:8888/finance-flow/finance-flow/src/api.php',{shareTransaction:true,transaction_id:transactionId,utilisateur_ids:selectedUtilisateurs});console.log(\"Transaction partagée avec succès.\");}console.log(\"Transaction ajoutée avec succès.\");onAddTransaction();}else{console.warn(\"Erreur détectée :\",response.data.message);}}catch(error){console.error(\"Erreur lors de l'ajout de la transaction :\",error);}};const filteredSousCategories=sousCategories.filter(sousCategorie=>sousCategorie.categorie_id===parseInt(selectedCategory));return/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:titre,onChange:e=>setTitre(e.target.value),placeholder:\"Titre\",required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:montant,onChange:e=>setMontant(e.target.value),placeholder:\"Montant\",required:true}),/*#__PURE__*/_jsxs(\"select\",{value:type,onChange:e=>setType(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"depense\",children:\"D\\xE9pense\"}),/*#__PURE__*/_jsx(\"option\",{value:\"revenu\",children:\"Revenu\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:date,onChange:e=>setDate(e.target.value),required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:lieu,onChange:e=>setLieu(e.target.value),placeholder:\"Lieu\"}),/*#__PURE__*/_jsx(\"textarea\",{value:description,onChange:e=>setDescription(e.target.value),placeholder:\"Description\"}),/*#__PURE__*/_jsx(\"label\",{children:\"Cat\\xE9gorie :\"}),/*#__PURE__*/_jsxs(\"select\",{value:selectedCategory,onChange:e=>setSelectedCategory(e.target.value),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"S\\xE9lectionnez une cat\\xE9gorie\"}),categories.map(categorie=>/*#__PURE__*/_jsx(\"option\",{value:categorie.id,children:categorie.nom},categorie.id))]}),/*#__PURE__*/_jsx(\"label\",{children:\"Sous-cat\\xE9gorie :\"}),/*#__PURE__*/_jsxs(\"select\",{value:selectedSousCategorie,onChange:e=>setSelectedSousCategorie(e.target.value),required:true,disabled:!selectedCategory,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"S\\xE9lectionnez une sous-cat\\xE9gorie\"}),filteredSousCategories.map(sousCategorie=>/*#__PURE__*/_jsx(\"option\",{value:sousCategorie.id,children:sousCategorie.nom},sousCategorie.id))]}),/*#__PURE__*/_jsx(\"label\",{children:\"Partager avec :\"}),/*#__PURE__*/_jsx(\"select\",{multiple:true,value:selectedUtilisateurs,onChange:e=>setSelectedUtilisateurs([...e.target.selectedOptions].map(option=>option.value)),children:utilisateurs.map(user=>/*#__PURE__*/_jsx(\"option\",{value:user.id,children:user.nom},user.id))}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Ajouter\"})]});}export default TransactionForm;","map":{"version":3,"names":["React","useState","useEffect","axios","jsx","_jsx","jsxs","_jsxs","TransactionForm","_ref","onAddTransaction","titre","setTitre","montant","setMontant","type","setType","date","setDate","lieu","setLieu","description","setDescription","categories","setCategories","sousCategories","setSousCategories","selectedCategory","setSelectedCategory","selectedSousCategorie","setSelectedSousCategorie","utilisateurs","setUtilisateurs","selectedUtilisateurs","setSelectedUtilisateurs","fetchData","categoriesResponse","get","data","utilisateursResponse","error","console","handleSubmit","e","preventDefault","warn","transaction","parseFloat","categorie_id","sous_categorie_id","response","post","status","transactionId","transaction_id","length","shareTransaction","utilisateur_ids","log","message","filteredSousCategories","filter","sousCategorie","parseInt","onSubmit","children","value","onChange","target","placeholder","required","map","categorie","id","nom","disabled","multiple","selectedOptions","option","user"],"sources":["/Applications/MAMP/htdocs/finance-flow/finance-flow/src/components/TransactionForm.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\n\nfunction TransactionForm({ onAddTransaction }) {\n    const [titre, setTitre] = useState('');\n    const [montant, setMontant] = useState('');\n    const [type, setType] = useState('depense');\n    const [date, setDate] = useState('');\n    const [lieu, setLieu] = useState('');\n    const [description, setDescription] = useState('');\n    const [categories, setCategories] = useState([]);\n    const [sousCategories, setSousCategories] = useState([]);\n    const [selectedCategory, setSelectedCategory] = useState('');\n    const [selectedSousCategorie, setSelectedSousCategorie] = useState('');\n    const [utilisateurs, setUtilisateurs] = useState([]);\n    const [selectedUtilisateurs, setSelectedUtilisateurs] = useState([]);\n\n    useEffect(() => {\n        const fetchData = async () => {\n            try {\n                const categoriesResponse = await axios.get('http://localhost:8888/finance-flow/finance-flow/src/api.php?getCategories=true');\n                setCategories(categoriesResponse.data.categories || []);\n                setSousCategories(categoriesResponse.data.sousCategories || []);\n\n                const utilisateursResponse = await axios.get('http://localhost:8888/finance-flow/finance-flow/src/api.php?getUtilisateurs=true');\n                setUtilisateurs(utilisateursResponse.data || []);\n            } catch (error) {\n                console.error(\"Erreur lors de la récupération des données :\", error);\n            }\n        };\n\n        fetchData();\n    }, []);\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n\n        if (!selectedCategory) {\n            console.warn(\"Catégorie non sélectionnée.\");\n            return;\n        }\n\n        const transaction = {\n            titre,\n            montant: parseFloat(montant),\n            type,\n            date,\n            lieu,\n            description,\n            categorie_id: selectedCategory,\n            sous_categorie_id: selectedSousCategorie\n        };\n\n        try {\n            const response = await axios.post('http://localhost:8888/finance-flow/finance-flow/src/api.php', transaction);\n            if (response.data.status === 'success') {\n                const transactionId = response.data.transaction_id;\n\n                // Partager la transaction si des utilisateurs sont sélectionnés\n                if (selectedUtilisateurs.length > 0) {\n                    await axios.post('http://localhost:8888/finance-flow/finance-flow/src/api.php', {\n                        shareTransaction: true,\n                        transaction_id: transactionId,\n                        utilisateur_ids: selectedUtilisateurs\n                    });\n                    console.log(\"Transaction partagée avec succès.\");\n                }\n\n                console.log(\"Transaction ajoutée avec succès.\");\n                onAddTransaction();\n            } else {\n                console.warn(\"Erreur détectée :\", response.data.message);\n            }\n        } catch (error) {\n            console.error(\"Erreur lors de l'ajout de la transaction :\", error);\n        }\n    };\n\n    const filteredSousCategories = sousCategories.filter(\n        (sousCategorie) => sousCategorie.categorie_id === parseInt(selectedCategory)\n    );\n\n    return (\n        <form onSubmit={handleSubmit}>\n            <input\n                type=\"text\"\n                value={titre}\n                onChange={(e) => setTitre(e.target.value)}\n                placeholder=\"Titre\"\n                required\n            />\n            <input\n                type=\"number\"\n                value={montant}\n                onChange={(e) => setMontant(e.target.value)}\n                placeholder=\"Montant\"\n                required\n            />\n            <select value={type} onChange={(e) => setType(e.target.value)}>\n                <option value=\"depense\">Dépense</option>\n                <option value=\"revenu\">Revenu</option>\n            </select>\n            <input\n                type=\"date\"\n                value={date}\n                onChange={(e) => setDate(e.target.value)}\n                required\n            />\n            <input\n                type=\"text\"\n                value={lieu}\n                onChange={(e) => setLieu(e.target.value)}\n                placeholder=\"Lieu\"\n            />\n            <textarea\n                value={description}\n                onChange={(e) => setDescription(e.target.value)}\n                placeholder=\"Description\"\n            ></textarea>\n\n            <label>Catégorie :</label>\n            <select\n                value={selectedCategory}\n                onChange={(e) => setSelectedCategory(e.target.value)}\n                required\n            >\n                <option value=\"\">Sélectionnez une catégorie</option>\n                {categories.map((categorie) => (\n                    <option key={categorie.id} value={categorie.id}>\n                        {categorie.nom}\n                    </option>\n                ))}\n            </select>\n\n            <label>Sous-catégorie :</label>\n            <select\n                value={selectedSousCategorie}\n                onChange={(e) => setSelectedSousCategorie(e.target.value)}\n                required\n                disabled={!selectedCategory}\n            >\n                <option value=\"\">Sélectionnez une sous-catégorie</option>\n                {filteredSousCategories.map((sousCategorie) => (\n                    <option key={sousCategorie.id} value={sousCategorie.id}>\n                        {sousCategorie.nom}\n                    </option>\n                ))}\n            </select>\n\n            <label>Partager avec :</label>\n            <select\n                multiple\n                value={selectedUtilisateurs}\n                onChange={(e) => setSelectedUtilisateurs([...e.target.selectedOptions].map(option => option.value))}\n            >\n                {utilisateurs.map((user) => (\n                    <option key={user.id} value={user.id}>\n                        {user.nom}\n                    </option>\n                ))}\n            </select>\n\n            <button type=\"submit\">Ajouter</button>\n        </form>\n    );\n}\n\nexport default TransactionForm;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,MAAO,CAAAC,KAAK,KAAM,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE1B,QAAS,CAAAC,eAAeA,CAAAC,IAAA,CAAuB,IAAtB,CAAEC,gBAAiB,CAAC,CAAAD,IAAA,CACzC,KAAM,CAACE,KAAK,CAAEC,QAAQ,CAAC,CAAGX,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACY,OAAO,CAAEC,UAAU,CAAC,CAAGb,QAAQ,CAAC,EAAE,CAAC,CAC1C,KAAM,CAACc,IAAI,CAAEC,OAAO,CAAC,CAAGf,QAAQ,CAAC,SAAS,CAAC,CAC3C,KAAM,CAACgB,IAAI,CAAEC,OAAO,CAAC,CAAGjB,QAAQ,CAAC,EAAE,CAAC,CACpC,KAAM,CAACkB,IAAI,CAAEC,OAAO,CAAC,CAAGnB,QAAQ,CAAC,EAAE,CAAC,CACpC,KAAM,CAACoB,WAAW,CAAEC,cAAc,CAAC,CAAGrB,QAAQ,CAAC,EAAE,CAAC,CAClD,KAAM,CAACsB,UAAU,CAAEC,aAAa,CAAC,CAAGvB,QAAQ,CAAC,EAAE,CAAC,CAChD,KAAM,CAACwB,cAAc,CAAEC,iBAAiB,CAAC,CAAGzB,QAAQ,CAAC,EAAE,CAAC,CACxD,KAAM,CAAC0B,gBAAgB,CAAEC,mBAAmB,CAAC,CAAG3B,QAAQ,CAAC,EAAE,CAAC,CAC5D,KAAM,CAAC4B,qBAAqB,CAAEC,wBAAwB,CAAC,CAAG7B,QAAQ,CAAC,EAAE,CAAC,CACtE,KAAM,CAAC8B,YAAY,CAAEC,eAAe,CAAC,CAAG/B,QAAQ,CAAC,EAAE,CAAC,CACpD,KAAM,CAACgC,oBAAoB,CAAEC,uBAAuB,CAAC,CAAGjC,QAAQ,CAAC,EAAE,CAAC,CAEpEC,SAAS,CAAC,IAAM,CACZ,KAAM,CAAAiC,SAAS,CAAG,KAAAA,CAAA,GAAY,CAC1B,GAAI,CACA,KAAM,CAAAC,kBAAkB,CAAG,KAAM,CAAAjC,KAAK,CAACkC,GAAG,CAAC,gFAAgF,CAAC,CAC5Hb,aAAa,CAACY,kBAAkB,CAACE,IAAI,CAACf,UAAU,EAAI,EAAE,CAAC,CACvDG,iBAAiB,CAACU,kBAAkB,CAACE,IAAI,CAACb,cAAc,EAAI,EAAE,CAAC,CAE/D,KAAM,CAAAc,oBAAoB,CAAG,KAAM,CAAApC,KAAK,CAACkC,GAAG,CAAC,kFAAkF,CAAC,CAChIL,eAAe,CAACO,oBAAoB,CAACD,IAAI,EAAI,EAAE,CAAC,CACpD,CAAE,MAAOE,KAAK,CAAE,CACZC,OAAO,CAACD,KAAK,CAAC,8CAA8C,CAAEA,KAAK,CAAC,CACxE,CACJ,CAAC,CAEDL,SAAS,CAAC,CAAC,CACf,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAO,YAAY,CAAG,KAAO,CAAAC,CAAC,EAAK,CAC9BA,CAAC,CAACC,cAAc,CAAC,CAAC,CAElB,GAAI,CAACjB,gBAAgB,CAAE,CACnBc,OAAO,CAACI,IAAI,CAAC,6BAA6B,CAAC,CAC3C,OACJ,CAEA,KAAM,CAAAC,WAAW,CAAG,CAChBnC,KAAK,CACLE,OAAO,CAAEkC,UAAU,CAAClC,OAAO,CAAC,CAC5BE,IAAI,CACJE,IAAI,CACJE,IAAI,CACJE,WAAW,CACX2B,YAAY,CAAErB,gBAAgB,CAC9BsB,iBAAiB,CAAEpB,qBACvB,CAAC,CAED,GAAI,CACA,KAAM,CAAAqB,QAAQ,CAAG,KAAM,CAAA/C,KAAK,CAACgD,IAAI,CAAC,6DAA6D,CAAEL,WAAW,CAAC,CAC7G,GAAII,QAAQ,CAACZ,IAAI,CAACc,MAAM,GAAK,SAAS,CAAE,CACpC,KAAM,CAAAC,aAAa,CAAGH,QAAQ,CAACZ,IAAI,CAACgB,cAAc,CAElD;AACA,GAAIrB,oBAAoB,CAACsB,MAAM,CAAG,CAAC,CAAE,CACjC,KAAM,CAAApD,KAAK,CAACgD,IAAI,CAAC,6DAA6D,CAAE,CAC5EK,gBAAgB,CAAE,IAAI,CACtBF,cAAc,CAAED,aAAa,CAC7BI,eAAe,CAAExB,oBACrB,CAAC,CAAC,CACFQ,OAAO,CAACiB,GAAG,CAAC,mCAAmC,CAAC,CACpD,CAEAjB,OAAO,CAACiB,GAAG,CAAC,kCAAkC,CAAC,CAC/ChD,gBAAgB,CAAC,CAAC,CACtB,CAAC,IAAM,CACH+B,OAAO,CAACI,IAAI,CAAC,mBAAmB,CAAEK,QAAQ,CAACZ,IAAI,CAACqB,OAAO,CAAC,CAC5D,CACJ,CAAE,MAAOnB,KAAK,CAAE,CACZC,OAAO,CAACD,KAAK,CAAC,4CAA4C,CAAEA,KAAK,CAAC,CACtE,CACJ,CAAC,CAED,KAAM,CAAAoB,sBAAsB,CAAGnC,cAAc,CAACoC,MAAM,CAC/CC,aAAa,EAAKA,aAAa,CAACd,YAAY,GAAKe,QAAQ,CAACpC,gBAAgB,CAC/E,CAAC,CAED,mBACIpB,KAAA,SAAMyD,QAAQ,CAAEtB,YAAa,CAAAuB,QAAA,eACzB5D,IAAA,UACIU,IAAI,CAAC,MAAM,CACXmD,KAAK,CAAEvD,KAAM,CACbwD,QAAQ,CAAGxB,CAAC,EAAK/B,QAAQ,CAAC+B,CAAC,CAACyB,MAAM,CAACF,KAAK,CAAE,CAC1CG,WAAW,CAAC,OAAO,CACnBC,QAAQ,MACX,CAAC,cACFjE,IAAA,UACIU,IAAI,CAAC,QAAQ,CACbmD,KAAK,CAAErD,OAAQ,CACfsD,QAAQ,CAAGxB,CAAC,EAAK7B,UAAU,CAAC6B,CAAC,CAACyB,MAAM,CAACF,KAAK,CAAE,CAC5CG,WAAW,CAAC,SAAS,CACrBC,QAAQ,MACX,CAAC,cACF/D,KAAA,WAAQ2D,KAAK,CAAEnD,IAAK,CAACoD,QAAQ,CAAGxB,CAAC,EAAK3B,OAAO,CAAC2B,CAAC,CAACyB,MAAM,CAACF,KAAK,CAAE,CAAAD,QAAA,eAC1D5D,IAAA,WAAQ6D,KAAK,CAAC,SAAS,CAAAD,QAAA,CAAC,YAAO,CAAQ,CAAC,cACxC5D,IAAA,WAAQ6D,KAAK,CAAC,QAAQ,CAAAD,QAAA,CAAC,QAAM,CAAQ,CAAC,EAClC,CAAC,cACT5D,IAAA,UACIU,IAAI,CAAC,MAAM,CACXmD,KAAK,CAAEjD,IAAK,CACZkD,QAAQ,CAAGxB,CAAC,EAAKzB,OAAO,CAACyB,CAAC,CAACyB,MAAM,CAACF,KAAK,CAAE,CACzCI,QAAQ,MACX,CAAC,cACFjE,IAAA,UACIU,IAAI,CAAC,MAAM,CACXmD,KAAK,CAAE/C,IAAK,CACZgD,QAAQ,CAAGxB,CAAC,EAAKvB,OAAO,CAACuB,CAAC,CAACyB,MAAM,CAACF,KAAK,CAAE,CACzCG,WAAW,CAAC,MAAM,CACrB,CAAC,cACFhE,IAAA,aACI6D,KAAK,CAAE7C,WAAY,CACnB8C,QAAQ,CAAGxB,CAAC,EAAKrB,cAAc,CAACqB,CAAC,CAACyB,MAAM,CAACF,KAAK,CAAE,CAChDG,WAAW,CAAC,aAAa,CAClB,CAAC,cAEZhE,IAAA,UAAA4D,QAAA,CAAO,gBAAW,CAAO,CAAC,cAC1B1D,KAAA,WACI2D,KAAK,CAAEvC,gBAAiB,CACxBwC,QAAQ,CAAGxB,CAAC,EAAKf,mBAAmB,CAACe,CAAC,CAACyB,MAAM,CAACF,KAAK,CAAE,CACrDI,QAAQ,MAAAL,QAAA,eAER5D,IAAA,WAAQ6D,KAAK,CAAC,EAAE,CAAAD,QAAA,CAAC,kCAA0B,CAAQ,CAAC,CACnD1C,UAAU,CAACgD,GAAG,CAAEC,SAAS,eACtBnE,IAAA,WAA2B6D,KAAK,CAAEM,SAAS,CAACC,EAAG,CAAAR,QAAA,CAC1CO,SAAS,CAACE,GAAG,EADLF,SAAS,CAACC,EAEf,CACX,CAAC,EACE,CAAC,cAETpE,IAAA,UAAA4D,QAAA,CAAO,qBAAgB,CAAO,CAAC,cAC/B1D,KAAA,WACI2D,KAAK,CAAErC,qBAAsB,CAC7BsC,QAAQ,CAAGxB,CAAC,EAAKb,wBAAwB,CAACa,CAAC,CAACyB,MAAM,CAACF,KAAK,CAAE,CAC1DI,QAAQ,MACRK,QAAQ,CAAE,CAAChD,gBAAiB,CAAAsC,QAAA,eAE5B5D,IAAA,WAAQ6D,KAAK,CAAC,EAAE,CAAAD,QAAA,CAAC,uCAA+B,CAAQ,CAAC,CACxDL,sBAAsB,CAACW,GAAG,CAAET,aAAa,eACtCzD,IAAA,WAA+B6D,KAAK,CAAEJ,aAAa,CAACW,EAAG,CAAAR,QAAA,CAClDH,aAAa,CAACY,GAAG,EADTZ,aAAa,CAACW,EAEnB,CACX,CAAC,EACE,CAAC,cAETpE,IAAA,UAAA4D,QAAA,CAAO,iBAAe,CAAO,CAAC,cAC9B5D,IAAA,WACIuE,QAAQ,MACRV,KAAK,CAAEjC,oBAAqB,CAC5BkC,QAAQ,CAAGxB,CAAC,EAAKT,uBAAuB,CAAC,CAAC,GAAGS,CAAC,CAACyB,MAAM,CAACS,eAAe,CAAC,CAACN,GAAG,CAACO,MAAM,EAAIA,MAAM,CAACZ,KAAK,CAAC,CAAE,CAAAD,QAAA,CAEnGlC,YAAY,CAACwC,GAAG,CAAEQ,IAAI,eACnB1E,IAAA,WAAsB6D,KAAK,CAAEa,IAAI,CAACN,EAAG,CAAAR,QAAA,CAChCc,IAAI,CAACL,GAAG,EADAK,IAAI,CAACN,EAEV,CACX,CAAC,CACE,CAAC,cAETpE,IAAA,WAAQU,IAAI,CAAC,QAAQ,CAAAkD,QAAA,CAAC,SAAO,CAAQ,CAAC,EACpC,CAAC,CAEf,CAEA,cAAe,CAAAzD,eAAe","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}